<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>8 transpositions of the chord scale buckets</title>
</head>

<body>
  <article id="alto-clef">
    <div class="melody"></div>
    <section class="tonic">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
    <section class="subdominant">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
    <section class="dominant">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
  </article>
  <article id="bb">
    <div class="melody"></div>
    <section class="tonic">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
    <section class="subdominant">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
    <section class="dominant">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
  </article>
  <article id="concert-pitch-bc">
    <div class="melody"></div>
    <section class="tonic">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
    <section class="subdominant">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
    <section class="dominant">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
  </article>
  <article id="concert-pitch-bc-8vb">
    <div class="melody"></div>
    <section class="tonic">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
    <section class="subdominant">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
    <section class="dominant">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
  </article>
  <article id="concert-pitch-tc">
    <div class="melody"></div>
    <section class="tonic">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
    <section class="subdominant">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
    <section class="dominant">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
  </article>
  <article id="concert-pitch-tc-8va">
    <div class="melody"></div>
    <section class="tonic">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
    <section class="subdominant">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
    <section class="dominant">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
  </article>
  <article id="eb">
    <div class="melody"></div>
    <section class="tonic">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
    <section class="subdominant">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
    <section class="dominant">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
  </article>
  <article id="f">
    <div class="melody"></div>
    <section class="tonic">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
    <section class="subdominant">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
    <section class="dominant">
      <output class="pitches"></output>
      <div class="score"></div>
    </section>
  </article>
  <script src="https://prod.flat-cdn.com/embed-js/v1.5.1/embed.min.js"></script>
  <script src="thick.js"></script>
  <script>
    async function main() {
      // load the scores from json
      const data = await (await fetch('beg-band.json')).json()
      console.table(data)

      // for each score in loadedData.scores
      //    construct a flat (not editable)embed object and give it the #transposition>.melody elem for its container
      //    construct a blank (not editable) flat io embed object 
      const scoreEmbeds = data.scores.map((scoreObj) => {

        //  refEmbed,
        //   tonicEmbed,
        //   subdominantEmbed,
        //   dominantEmbed,
        //   scaleDegreeElems,
        //   instrName,
        //   octaveShift = 0

        const scaleDegreeElems= {
          tonic: document.querySelector(`#${scoreObj.transposition}>.tonic>.pitches`),
          subdominant: document.querySelector(`#${scoreObj.transposition}>.subdominant>.pitches`),
          dominant: document.querySelector(`#${scoreObj.transposition}>.dominant>.pitches`),
        }


        const melodyElem = `#${scoreObj.transposition}>.melody`
        console.log(melodyElem)
        const tonicElem = `#${scoreObj.transposition}>.tonic`
        console.log(tonicElem)
        const subdominantElem = `#${scoreObj.transposition}>.subdominant`
        const dominantElem = `#${scoreObj.transposition}>.dominant`
        const container = document.querySelector(melodyElem);
        const embed = new Flat.Embed(container, {
          "width": "100%",
          "height": "300",
          "score": scoreObj.scoreId,
          "embedParams": {
            "branding": false,
            "controlsPlay": false,
            "appId": appId,
            "sharingKey": scoreObj.sharingKey
          }
        })


        const tonicContainer = document.querySelector(tonicElem);
        const tonicEmbed = new Flat.Embed(tonicContainer, {
          "width": "100%",
          "height": "300",
          "score": 'blank',
          "embedParams": {
            "branding": false,
            "controlsPlay": false,
            "appId": appId,
          }
        })

        const subdominantContainer = document.querySelector(subdominantElem);
        const subdominantEmbed = new Flat.Embed(subdominantContainer, {
          "width": "100%",
          "height": "300",
          "score": 'blank',
          "embedParams": {
            "branding": false,
            "controlsPlay": false,
            "appId": appId,
          }
        })

        const dominantContainer = document.querySelector(dominantElem);
        const dominantEmbed = new Flat.Embed(dominantContainer, {
          "width": "100%",
          "height": "300",
          "score": 'blank',
          "embedParams": {
            "branding": false,
            "controlsPlay": false,
            "appId": appId,
          }
        })
        refToChordScaleBuckets(embed, tonicEmbed, subdominantEmbed, dominantEmbed, scaleDegreeElems, "Matt")
        return { embed, tonicEmbed, subdominantEmbed, dominantEmbed }
      });


      // scoreEmbeds.map((score)=>{
      //   refToChordScaleBuckets()
      // })
       //  refEmbed,
      //   tonicEmbed,
      //   subdominantEmbed,
      //   dominantEmbed,
      //   scaleDegreeElems,
      //   instrName,
      //   octaveShift = 0

      //            and then tell the flatembed object to load that data
    }
    main()
  </script>
</body>

</html>