<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>8 transpositions of the chord scale buckets</title>
</head>

<body>
  <article id="alto-clef">
    <section class="melody"></section>
    <section class="tonic"></section>
  </article>
  <article id="bb">
    <section class="melody"></section>
    <section class="tonic"></section>
  </article>
  <article id="concert-pitch-bc">
    <section class="melody"></section>
    <section class="tonic"></section>
  </article>
  <article id="concert-pitch-bc-8vb">
    <section class="melody"></section>
    <section class="tonic"></section>
  </article>
  <article id="concert-pitch-tc">
    <section class="melody"></section>
    <section class="tonic"></section>
  </article>
  <article id="concert-pitch-tc-8va">
    <section class="melody"></section>
    <section class="tonic"></section>
  </article>
  <article id="eb">
    <section class="melody"></section>
    <section class="tonic"></section>
  </article>
  <article id="f">
    <section class="melody"></section>
    <section class="tonic"></section>
  </article>
  <script src="https://prod.flat-cdn.com/embed-js/v1.5.1/embed.min.js"></script>
  <script src="thick.js"></script>
  <script>
    async function main() {
      // load the scores from json
      const data = await (await fetch('beg-band.json')).json()
      console.table(data)

      // for each score in loadedData.scores
      //    construct a flat (not editable)embed object and give it the #transposition>.melody elem for its container
      //    construct a blank (not editable) flat io embed object 
      const scoreEmbeds = data.scores.map((scoreObj) => {
        const melodyElem = `#${scoreObj.transposition}>.melody`
        console.log(melodyElem)
        const tonicElem = `#${scoreObj.transposition}>.tonic`
        console.log(tonicElem)
        const container = document.querySelector(melodyElem);
        const embed = new Flat.Embed(container, {
          "width": "100%",
          "height": "300",
          "score": scoreObj.scoreId,
          "embedParams": {
            "branding": false,
            "controlsPlay": false,
            "appId": appId,
            "sharingKey": scoreObj.sharingKey
          }
        })


        const tonicContainer = document.querySelector(tonicElem);
        const tonicEmbed = new Flat.Embed(tonicContainer, {
          "width": "100%",
          "height": "300",
          "score": 'blank',
          "embedParams": {
            "branding": false,
            "controlsPlay": false,
            "appId": appId,
          }
        })
        return { embed, tonicEmbed }
      });



      //            and then generate the corresponding tonic chord scale bucket json 
      const tonicChordScaleJSONInEb = await (await fetch('tonic-eb-as-minimized.json')).json()
      console.log(tonicChordScaleJSONInEb);



      refToChordScaleBuckets(drBbEmbed, bbTonicBucketEmbed, bbSubdominantBucketEmbed, bbDominantBucketEmbed, {
        tonic: document.getElementById('tonic-bb-scale-degrees'),
        subdominant: document.getElementById('subdominant-bb-scale-degrees'),
        dominant: document.getElementById('dominant-bb-scale-degrees')
      })

          //            and then tell the flatembed object to load that data
        }
    main()
  </script>
</body>

</html>